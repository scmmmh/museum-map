<!DOCTYPE html>
<html>
  <?py import json ?>
  <py:def function="tree(node)">
    <ul>
      <li py:for="child in node.children"><a href="${request.route_url('explore.group', gid=child.id)}">${child.title} [${len(child.items)}]</a>
        ${tree(child)}
      </li>
    </ul>
  </py:def>
  <head>
    <meta charset="utf-8"/>
    <title>${current.title}</title>
    <link rel="stylesheet" href="${request.static_url('museum_map:static/application.css')}"/>
  </head>
  <body>
    <div class="grid-y grid-frame">
      <header class="cell shrink">
        The header goes in here
      </header>
      <article class="cell auto cell-block-container">
        <div class="grid-x cell-block-y">
          <aside class="cell large-4">
            <div class="grid-y cell-block-y">
              <div id="overview" class="cell large-8 cell-block-y">
                <ul>
                  <li py:for="floor in root.children" data-size="${len(floor.items)}"><a href="${request.route_url('explore.group', gid=floor.id)}">${floor.title}</a>
                    <ul>
                      <li py:for="sector in floor.children" data-size="${len(sector.items)}"><a href="${request.route_url('explore.group', gid=sector.id)}">${sector.title}</a>
                        <ul>
                          <li py:for="room in sector.children" data-size="${len(room.items)}"><a href="${request.route_url('explore.group', gid=room.id)}">${room.title}</a></li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
                <canvas></canvas>
              </div>
              <div class="cell large-4 cell-block-y">
                <ul>
                  <li py:for="floor in root.children" data-size="${len(floor.items)}"><a href="${request.route_url('explore.group', gid=floor.id)}">${floor.title} [${len(floor.items)}]</a>
                    <ul>
                      <li py:for="sector in floor.children" data-size="${len(sector.items)}"><a href="${request.route_url('explore.group', gid=sector.id)}">${sector.title} [${len(sector.items)}]</a>
                        <ul>
                          <li py:for="room in sector.children" data-size="${len(room.items)}"><a href="${request.route_url('explore.group', gid=room.id)}">${room.title} [${len(room.items)}]</a></li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </aside>
          <section class="cell large-8 cell-block-y">
            <ul id="gallery" py:if="current">
              <py:for each="item in current.items">
                <py:if test="item['images']">
                  <li id="item-${item.id}" class="item" data-attributes="${json.dumps(item.attributes)}" data-details="details-${item.id}"><a href="#">
                    <picture data-src="http://www.liverpoolmuseums.org.uk/collections2015/images/${item['images'][0]['path'].replace('\\', '/')}/v0_medium.jpg" class="pre-load">
                      <img src="${request.static_url('museum_map:static/images/loading-black.svg')}" alt="${item['title']}"/>
                    </picture>
                    <span class="title">${item['title']}</span>
                  </a></li>
                  <li id="details-${item.id}" style="display:none;" class="details">
                    <div class="marker"> </div>
                    <div class="grid-x grid-padding-x content">
                      <div class="close"><a href="#">ðŸž¨</a></div>
                      <div class="cell large-6 cell-block-y text-center">
                        <div class="grid-y cell-block-y justify-items-center">
                          <div class="cell shrink max-height">
                            <picture data-src="http://www.liverpoolmuseums.org.uk/collections2015/images/${item['images'][0]['path'].replace('\\', '/')}/v0_large.jpg" class="pre-load">
                              <img src="${request.static_url('museum_map:static/images/loading-black.svg')}" alt=""/>
                            </picture>
                          </div>
                        </div>
                      </div>
                      <div class="cell large-6 cell-block-y content-text">
                        <div class="grid-y">
                          <div class="cell shrink">
                            <h2>${item['title']}</h2>
                          </div>
                          <div class="cell auto">
                            <p py:if="item['description']" class="description">${item['description']}</p>
                            <p py:if="item['note']" class="note">${item['note']}</p>
                            <div class="grid-x large-up-4 metadata">
                              <div py:for="category, label in [('category', 'Type'), ('culture', 'Culture'), ('date_made', 'Date made'), ('collector', 'Collector'), ('date_collected', 'Date collected'), ('measurements', 'Measurements'), ('place_made', 'Made in'), ('maker', 'Made by'), ('accession_no', 'Accession No')]" py:if="item[category]" class="cell" data-attribute="${category}">
                                <h3>${category}</h3>
                                <p>${item[category]}</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </li>
                </py:if>
              </py:for>
            </ul>
          </section>
        </div>
      </article>
    </div>
    <script src="${request.static_url('museum_map:static/application.js')}"></script>
    <script>
    $('article').app();
    $('#overview').overview();
    $('#gallery').gallery();
    </script>
  </body>
</html>
